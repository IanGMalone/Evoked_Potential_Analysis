---
title: "Basic Stats"
author: "Ian Malone"
date: "5/8/2021"
output: html_document
---


```{r setup, include=FALSE}
library(tidyverse)

df_timebin1 <- read.csv(file = 'D:\\Neilsen\\Dataframes\\df_anova.csv')

df_timebin <- df_timebin1 %>%
  mutate(Group = as_factor(Group)) %>% 
  mutate(Time_Bin = as_factor(Time_Bin)) %>%
  mutate(Day = as_factor(Day))

df_motor_threshold1 <- read.csv(file = 'D:\\Neilsen\\Dataframes\\df_motor_threshold.csv')

df_motor_threshold <- df_motor_threshold1 %>%
  mutate(Group = as_factor(Group)) %>% 
  mutate(Animal = as_factor(Animal)) %>%
  mutate(Day = as_factor(Day)) %>%
  mutate(Injury = if_else(str_detect(Group, "Yes Injury"), "Yes", "No"),
         Therapy = if_else(str_detect(Group, "Yes EES"), "Yes", "No"))

df_peak_time1 <- read.csv(file = 'D:\\Neilsen\\Dataframes\\df_plotter.csv')

df_peak_time <- df_peak_time1 %>%
  mutate(Group = as_factor(Group)) %>% 
  mutate(Animal = as_factor(Animal)) %>%
  mutate(Day = as_factor(Day_Stim)) %>%
  mutate(Side = as_factor(Side)) %>%
  mutate(Injury = if_else(str_detect(Group, "Yes Injury"), "Yes", "No"),
         Therapy = if_else(str_detect(Group, "Yes EES"), "Yes", "No"))

```


#### ANOVA and pairwise comparisons on time bin data ####
```{r}
df = 
  df_timebin %>% 
  filter(Day == 4) # change which day is being compared here

anova_time_bin <- aov(Scalar_Original_Value ~ Group + Time_Bin + Group:Time_Bin, data = df)
summary(anova_time_bin)
TukeyHSD(anova_time_bin)

```


#### ANOVA and pairwise comparisons on motor threshold data ####
```{r}

df = 
  df_motor_threshold %>% 
  filter(Side == 'Left') # %>% 
 # filter(Day == 4)

anova_motor_threshold <- aov(Motor_Threshold ~ Injury * Day, data = df)
summary(anova_motor_threshold)
TukeyHSD(anova_motor_threshold)

```


#### ANOVA and pairwise comparisons on time to peak data ####
```{r}

df = 
  df_peak_time %>% 
  filter(Side == 'Right') #%>% 
  #filter(Day == 4)

anova_peak_time <- aov(Time_of_Peak ~ Therapy*Day, data = df)
summary(anova_peak_time)
TukeyHSD(anova_peak_time)

```